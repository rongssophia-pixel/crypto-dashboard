# =============================================================================
# Crypto Dashboard - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your actual values
# This file contains all configuration needed for local development
#
# For local development: Infrastructure runs in Docker, services run locally
# All connection strings below use localhost (services will connect to
# Dockerized infrastructure on localhost ports)
# =============================================================================

# -----------------------------------------------------------------------------
# PostgreSQL Database
# -----------------------------------------------------------------------------
# Used by: ingestion-service, notification-service, storage-service
# Docker container exposes: localhost:5432
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=crypto_dashboard
POSTGRES_USER=crypto_user
POSTGRES_PASSWORD=your_secure_password_here

# -----------------------------------------------------------------------------
# ClickHouse Analytics Database
# -----------------------------------------------------------------------------
# Used by: analytics-service, stream-processing-service, storage-service
# 
# LOCAL DEVELOPMENT (Docker):
# CLICKHOUSE_HOST=localhost
# CLICKHOUSE_PORT=9000
# CLICKHOUSE_SECURE=false
# CLICKHOUSE_VERIFY=true
#
# RAILWAY/PRODUCTION (ClickHouse Cloud - https://clickhouse.cloud):
# The host validator will automatically strip the https:// prefix and port
# You can use either format:
# CLICKHOUSE_HOST=https://abc123.us-east-1.aws.clickhouse.cloud:8443
# OR
# CLICKHOUSE_HOST=abc123.us-east-1.aws.clickhouse.cloud
# CLICKHOUSE_PORT=8443
# CLICKHOUSE_SECURE=true
# CLICKHOUSE_VERIFY=true
CLICKHOUSE_HOST=localhost
CLICKHOUSE_PORT=9000
CLICKHOUSE_DB=crypto_analytics
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=
CLICKHOUSE_SECURE=false
CLICKHOUSE_VERIFY=true

# -----------------------------------------------------------------------------
# Kafka Message Broker
# -----------------------------------------------------------------------------
# Used by: ingestion-service, stream-processing-service, notification-service
#
# LOCAL DEVELOPMENT (Docker):
# KAFKA_BOOTSTRAP_SERVERS=localhost:9092
# KAFKA_SECURITY_PROTOCOL=PLAINTEXT
# KAFKA_SASL_MECHANISM=
# KAFKA_SASL_USERNAME=
# KAFKA_SASL_PASSWORD=
#
# RAILWAY/PRODUCTION (Confluent Cloud - https://confluent.cloud):
# KAFKA_BOOTSTRAP_SERVERS=pkc-xxxxx.us-east-1.aws.confluent.cloud:9092
# KAFKA_SECURITY_PROTOCOL=SASL_SSL
# KAFKA_SASL_MECHANISM=PLAIN
# KAFKA_SASL_USERNAME=<confluent-api-key>
# KAFKA_SASL_PASSWORD=<confluent-api-secret>
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_SECURITY_PROTOCOL=PLAINTEXT
KAFKA_SASL_MECHANISM=
KAFKA_SASL_USERNAME=
KAFKA_SASL_PASSWORD=

# Kafka Topics (auto-created if not exists)
KAFKA_TOPIC_RAW_MARKET_DATA=crypto.raw.market-data
KAFKA_TOPIC_PROCESSED_MARKET_DATA=crypto.processed.market-data
KAFKA_TOPIC_ALERTS=crypto.alerts

# -----------------------------------------------------------------------------
# AWS / LocalStack (S3 Mock)
# -----------------------------------------------------------------------------
# Used by: storage-service
# Docker container exposes: localhost:4566
AWS_ENDPOINT_URL=http://localhost:4566
AWS_ACCESS_KEY_ID=test
AWS_SECRET_ACCESS_KEY=test
AWS_DEFAULT_REGION=us-east-1
AWS_REGION=us-east-1
S3_BUCKET_NAME=crypto-dashboard-data
ATHENA_OUTPUT_BUCKET=crypto-athena-results
ATHENA_DATABASE=crypto_archive
ATHENA_WORKGROUP=primary

# -----------------------------------------------------------------------------
# Binance API Configuration
# -----------------------------------------------------------------------------
# Used by: ingestion-service
# Optional: Leave empty for public data only
BINANCE_API_KEY=
BINANCE_API_SECRET=
BINANCE_WEBSOCKET_URL=wss://stream.binance.us:9443

# -----------------------------------------------------------------------------
# JWT Authentication
# -----------------------------------------------------------------------------
# Used by: All services
# IMPORTANT: Change this to a secure random string in production!
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=dev-secret-key-change-in-production-use-openssl-rand-hex-32
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRATION_MINUTES=60
REFRESH_TOKEN_EXPIRATION_DAYS=7

# Email verification and password reset
VERIFICATION_TOKEN_EXPIRATION_HOURS=24
PASSWORD_RESET_TOKEN_EXPIRATION_HOURS=1
FRONTEND_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Email Notification Provider
# -----------------------------------------------------------------------------
# Used by: notification-service
# Providers: sendgrid, mailgun, ses
EMAIL_PROVIDER=sendgrid
EMAIL_API_KEY=your_email_api_key_here
EMAIL_FROM_ADDRESS=noreply@yourdomain.com
EMAIL_FROM_NAME=Crypto Analytics

# -----------------------------------------------------------------------------
# Service Ports (for local development)
# -----------------------------------------------------------------------------
# These are the ports where services listen when running locally
# gRPC ports
INGESTION_SERVICE_PORT=50051
ANALYTICS_SERVICE_PORT=50052
STORAGE_SERVICE_PORT=50053
NOTIFICATION_SERVICE_PORT=50054
STREAM_PROCESSING_SERVICE_PORT=50055

# HTTP/REST API ports
API_GATEWAY_PORT=8000
INGESTION_HTTP_PORT=8001
ANALYTICS_HTTP_PORT=8002
STORAGE_HTTP_PORT=8003
NOTIFICATION_HTTP_PORT=8004
STREAM_PROCESSING_HTTP_PORT=8005

# -----------------------------------------------------------------------------
# Stream Processing Configuration
# -----------------------------------------------------------------------------
# NOTE: If using Confluent Flink for stream processing, you can disable
# the stream-processing-service by commenting it out in supervisord.conf
KAFKA_CONSUMER_GROUP=stream-processing-group
CANDLE_INTERVALS=1m,5m,15m,1h
BATCH_SIZE=100
FLUSH_INTERVAL_SECONDS=5

# -----------------------------------------------------------------------------
# Analytics Service Configuration
# -----------------------------------------------------------------------------
DEFAULT_QUERY_LIMIT=1000
MAX_QUERY_LIMIT=10000
DEFAULT_CANDLE_LIMIT=500
MAX_CANDLE_LIMIT=5000
CACHE_ENABLED=true
CACHE_TTL_SECONDS=60

# -----------------------------------------------------------------------------
# Monitoring (Prometheus/Grafana)
# -----------------------------------------------------------------------------
# Prometheus metrics ports for each service
PROMETHEUS_PORT_INGESTION=9100
PROMETHEUS_PORT_ANALYTICS=9102
PROMETHEUS_PORT_STORAGE=9103
PROMETHEUS_PORT_NOTIFICATION=9104
PROMETHEUS_PORT_STREAM_PROCESSING=9105

# Grafana Admin Credentials
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=admin

# -----------------------------------------------------------------------------
# CORS Configuration (API Gateway)
# -----------------------------------------------------------------------------
CORS_ORIGINS=["*"]

# -----------------------------------------------------------------------------
# Development / Debug Flags
# -----------------------------------------------------------------------------
DEBUG=1
LOG_LEVEL=INFO
